# Workflow Tracker Configuration Example
# Copy this to config/local.yaml and fill in your values

# Repository to scan
repository:
  # Path to the repository (can be absolute or relative)
  path: "/path/to/your/repo"
  # Branch to scan (optional, defaults to current branch)
  branch: "main"

# Confluence integration
confluence:
  # Confluence Cloud URL (e.g., https://yourcompany.atlassian.net)
  url: "https://your-domain.atlassian.net"
  # Your email address
  username: "your.email@company.com"
  # API token (generate from https://id.atlassian.com/manage-profile/security/api-tokens)
  api_token: "your-api-token-here"
  # Personal space key (e.g., "~123456789abcdef" or your user ID)
  # To find your personal space: Go to Confluence > Spaces > Personal
  space_key: "~YOURUSERID"
  # Parent page ID (optional - creates pages under this parent)
  parent_page_id: null

  # Auto-diagram generation (used with --auto-diagrams flag)
  # When enabled, automatically generates and embeds Mermaid diagrams in Confluence
  auto_diagrams:
    # Which modules/directories to create diagrams for
    # Examples: ["Services", "Controllers", "Repositories"]
    modules:
      - "Services"
      - "Controllers"
    # Which database tables to diagram
    # Example: ["Users", "Orders", "Products"]
    tables: []
    # Which API endpoints to diagram
    # Example: ["/api/users", "/api/orders"]
    endpoints: []
    # Maximum nodes per diagram (keeps diagrams readable)
    max_nodes_per_diagram: 50

# Scanning options
scanner:
  # File extensions to scan
  include_extensions:
    - ".cs"      # C# files
    - ".ts"      # TypeScript files
    - ".js"      # JavaScript files
    - ".sql"     # SQL files

  # Directories to exclude from scanning (CRITICAL for performance!)
  # These directories contain dependencies, build artifacts, or non-source files
  exclude_dirs:
    # Package managers
    - "node_modules"     # NPM/Yarn packages
    - "packages"         # NuGet packages (C#)
    - "vendor"           # Composer/Go packages
    - "bower_components" # Bower packages

    # Build outputs
    - "bin"              # C# compiled binaries
    - "obj"              # C# intermediate objects
    - "dist"             # Distribution builds
    - "build"            # Build output
    - "out"              # Output directory
    - "target"           # Java/Maven build
    - ".next"            # Next.js build
    - ".nuxt"            # Nuxt.js build

    # Version control
    - ".git"             # Git repository data
    - ".svn"             # SVN repository data
    - ".hg"              # Mercurial repository data

    # IDE and editor directories
    - ".vs"              # Visual Studio
    - ".vscode"          # VS Code settings
    - ".idea"            # JetBrains IDEs
    - ".eclipse"         # Eclipse

    # Test coverage and reports
    - "coverage"         # Code coverage reports
    - "TestResults"      # C# test results
    - ".nyc_output"      # NYC coverage

    # Temporary and cache directories
    - "tmp"              # Temporary files
    - "temp"             # Temporary files
    - ".cache"           # Cache directory
    - ".sass-cache"      # Sass cache

    # Documentation builds
    - "docs/_build"      # Sphinx builds
    - "site"             # MkDocs builds

    # Docker
    - ".docker"          # Docker build cache

  # Additional file patterns to exclude (glob patterns)
  exclude_patterns:
    - "*.min.js"         # Minified JavaScript (no useful patterns)
    - "*.bundle.js"      # Bundled JavaScript
    - "*.min.css"        # Minified CSS
    - "*.map"            # Source maps
    - "*.designer.cs"    # Auto-generated designer files
    - "*.g.cs"           # Auto-generated files
    - "*.generated.cs"   # Auto-generated files

  # Workflow patterns to detect
  detect:
    database: true       # Database operations (SQL, EF Core, etc.)
    api_calls: true      # HTTP/REST API calls
    file_io: true        # File read/write operations
    message_queues: true # Message queue operations
    data_transforms: true # Data mapping/transformation

  # Edge inference options (for connecting workflow nodes)
  edge_inference:
    enabled: true        # Set to false to skip edge inference (faster for large repos)
    proximity_edges: true # Connect nodes within same file
    data_flow_edges: true # Infer data flow patterns (API->DB, DB->Transform, etc.)
    max_line_distance: 20 # Maximum lines between nodes to create proximity edge

# Output options
output:
  # Directory for generated artifacts
  directory: "./output"
  # Formats to generate
  formats:
    - "html"     # Interactive HTML graph
    - "png"      # Static PNG image
    - "svg"      # SVG vector image
    - "json"     # JSON data for programmatic access
    - "markdown" # Markdown documentation

# Visualization options
visualization:
  # Maximum nodes for HTML/PNG/SVG rendering (prevents hanging on large graphs)
  # Graphs larger than this will only generate JSON/Markdown
  max_nodes: 5000
  # Graph layout algorithm (dot, neato, fdp, sfdp, circo, twopi)
  layout: "dot"
  # Include source code snippets in nodes
  include_code_snippets: true
  # Maximum snippet length
  max_snippet_length: 100
  # Group nodes by file/module
  group_by_module: true

# CI/CD mode
ci_mode:
  # When true, runs headless and updates Confluence automatically
  enabled: false
  # Exit with error code if workflows changed
  fail_on_changes: false
