# ============================================================================
# Pinata Code - Environment Variables
# ============================================================================
# This is the configuration file for both:
#   1. Legacy Streamlit app (standalone tool)
#   2. Production SaaS platform (React + FastAPI)
#
# Quick Setup:
# 1. cp .env.example .env
# 2. Edit .env with your values below
# 3. Run: docker-compose up (for development)
# ============================================================================

# ============================================
# APPLICATION
# ============================================
ENVIRONMENT=development  # development, staging, production
LOG_LEVEL=debug         # debug, info, warning, error

# ============================================
# DATABASE (PostgreSQL)
# ============================================
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=pinata_dev
DB_HOST=db              # 'db' for Docker, 'localhost' for local
DB_PORT=5432

# Full connection string (auto-generated)
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# ============================================
# CACHE & QUEUE (Redis)
# ============================================
REDIS_HOST=redis        # 'redis' for Docker, 'localhost' for local
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/0

# Celery background jobs
CELERY_BROKER_URL=redis://${REDIS_HOST}:${REDIS_PORT}/1
CELERY_RESULT_BACKEND=redis://${REDIS_HOST}:${REDIS_PORT}/2

# ============================================
# OBJECT STORAGE (S3/MinIO)
# ============================================
# Development (MinIO)
S3_ENDPOINT=http://minio:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin
S3_BUCKET=pinata-scans
S3_REGION=us-east-1

# Production (AWS S3) - uncomment and configure
# S3_ENDPOINT=https://s3.amazonaws.com
# S3_ACCESS_KEY=your-aws-access-key
# S3_SECRET_KEY=your-aws-secret-key

# ============================================
# AUTHENTICATION (Clerk.dev)
# ============================================
# Get these from https://dashboard.clerk.com
CLERK_PUBLISHABLE_KEY=pk_test_xxxxx
CLERK_SECRET_KEY=sk_test_xxxxx

# Frontend public key
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=${CLERK_PUBLISHABLE_KEY}

# ============================================
# BILLING (Stripe)
# ============================================
# Get these from https://dashboard.stripe.com
STRIPE_PUBLISHABLE_KEY=pk_test_xxxxx
STRIPE_SECRET_KEY=sk_test_xxxxx
STRIPE_WEBHOOK_SECRET=whsec_xxxxx

# Price IDs for subscription plans
STRIPE_PRICE_ID_TEAM=price_xxxxx
STRIPE_PRICE_ID_ENTERPRISE=price_xxxxx

# Frontend public key
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=${STRIPE_PUBLISHABLE_KEY}

# ============================================
# FRONTEND (Next.js)
# ============================================
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_WS_URL=ws://localhost:8000
NEXT_PUBLIC_APP_URL=http://localhost:3000

# ============================================
# MONITORING & ANALYTICS
# ============================================
# Sentry (Error Tracking) - https://sentry.io
SENTRY_DSN=
NEXT_PUBLIC_SENTRY_DSN=${SENTRY_DSN}

# PostHog (Product Analytics) - https://posthog.com
NEXT_PUBLIC_POSTHOG_KEY=
NEXT_PUBLIC_POSTHOG_HOST=https://app.posthog.com

# Datadog (APM - Production only)
DD_API_KEY=
DD_APP_KEY=
DD_SITE=datadoghq.com

# ============================================
# SECURITY
# ============================================
# Secret key for JWT tokens (generate: openssl rand -hex 32)
SECRET_KEY=your-secret-key-here-change-in-production

# CORS allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# ============================================
# SCANNING ENGINE
# ============================================
MAX_CONCURRENT_SCANS=5
SCAN_TIMEOUT=3600
MAX_FILE_SIZE=10485760  # 10MB
FILE_EXTENSIONS=.cs,.ts,.js,.py,.java,.go

# Local repositories path (for Docker development)
# This directory will be mounted to /repos inside the container
# Examples:
#   Windows: C:\Users\jparker\github
#   macOS/Linux: /Users/jparker/github
# Leave empty to use ./repos (relative to docker-compose.yml)
LOCAL_REPOS_PATH=

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# ============================================
# EMAIL (Optional - for notifications)
# ============================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@pinatacode.com

# ============================================
# GIT INTEGRATION (Optional)
# ============================================
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_WEBHOOK_SECRET=

GITLAB_CLIENT_ID=
GITLAB_CLIENT_SECRET=
GITLAB_WEBHOOK_SECRET=

# ============================================
# LEGACY: Confluence Integration (Streamlit App)
# ============================================
# Get API token: https://id.atlassian.com/manage-profile/security/api-tokens
CONFLUENCE_URL=https://your-domain.atlassian.net
CONFLUENCE_USERNAME=your.email@company.com
CONFLUENCE_API_TOKEN=your-api-token-here
CONFLUENCE_SPACE_KEY=~YOURUSERID
CONFLUENCE_ENABLED=false

# ============================================
# LEGACY: Repository Configuration (Streamlit App)
# ============================================
# For Docker: Full path to repository to scan
# Examples:
#   REPO_TO_SCAN=/home/user/projects/my-app
#   REPO_TO_SCAN=C:\Users\jparker\source\MyApp
REPO_TO_SCAN=/path/to/your/repo

# CI/CD mode (headless execution)
CI_MODE=false

# Optional: Override output directory
# OUTPUT_DIR=./output

# Auto-diagram generation (comma-separated)
# AUTO_DIAGRAM_MODULES=Services,Controllers
# AUTO_DIAGRAM_TABLES=Users,Orders,Products
# AUTO_DIAGRAM_ENDPOINTS=/api/users,/api/orders

# ============================================
# DEVELOPMENT TOOLS
# ============================================
# PgAdmin (database GUI)
PGADMIN_DEFAULT_EMAIL=admin@pinatacode.com
PGADMIN_DEFAULT_PASSWORD=admin

# Hot reload
WATCHFILES_FORCE_POLLING=false
